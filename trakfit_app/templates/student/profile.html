{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TrakFit - Pre-Test Entry</title>
    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&family=Albert+Sans:wght@400;600&family=Atkinson+Hyperlegible:wght@400&display=swap"
      rel="stylesheet"
    />
    <!-- Custom CSS -->
    <style>
      :root {
        --primary-color: #3a7ca5;
        --light-blue: #9ec5e5;
        --dark-text: #2c3e50;
        --light-bg: #fafafa;
        --input-bg: #f3f3f3;
      }

      body {
        font-family: "Sarabun", sans-serif;
        background-color: var(--light-bg);
        overflow-x: hidden;
      }

      .main-content {
        margin-left: 400px;
        padding: 20px;
        min-height: 100vh;
      }

      .brand-font {
        font-family: "Albert Sans", sans-serif;
      }

      .form-container {
        background: #fafafa;
        box-shadow: 0 4px 4px rgba(0, 0, 0, 0.25);
        border-radius: 54px;
        padding: 40px;
      }

      .form-section-title {
        color: black;
        font-size: 1.5rem;
        font-family: "Albert Sans", sans-serif;
        font-weight: 400;
        margin-bottom: 1.5rem;
      }

      .form-label {
        color: black;
        font-size: 1.25rem;
        font-family: "Sarabun", sans-serif;
        font-weight: 300;
        margin-bottom: 0.5rem;
      }

      .form-input {
        background: #f3f3f3;
        border-radius: 15px;
        border: 1px solid #a2c4d9;
        height: 57px;
        font-size: 1.25rem;
        padding: 0 20px;
        padding-right: 110px; /* Increased slightly for better clearance */
      }

      .form-input:read-only {
        background: #f3f3f3;
        cursor: default;
      }

      .form-input::placeholder {
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.25rem;
        font-family: "Sarabun", sans-serif;
        font-weight: 400;
      }

      .unit-badge {
        background: #9ec5e5;
        box-shadow: 0 4px 4px rgba(0, 0, 0, 0.25);
        border-radius: 15px;
        padding: 8px 18px; /* Reduced padding for better fit */
        color: black;
        font-size: 1.1rem;
        font-family: "Sarabun", sans-serif;
        font-weight: 800;
        white-space: nowrap;
        line-height: 1.5; /* Better text vertical alignment */
        display: inline-flex; /* Use flexbox for better centering */
        align-items: center; /* Vertically center the text */
        height: 38px; /* Fixed height for consistent sizing */
      }

      .save-btn {
        background: #3a7ca5;
        box-shadow: 0 4px 4px rgba(0, 0, 0, 0.25);
        border-radius: 40px;
        color: white;
        font-size: 1.4rem;
        font-family: "Albert Sans", sans-serif;
        font-weight: 600;
        padding: 12px 40px;
        border: none;
      }

      .user-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        object-fit: cover;
      }

      .info-text {
        color: black;
        font-size: 1.5rem;
        font-family: "Atkinson Hyperlegible", sans-serif;
        font-weight: 400;
      }

      @media (max-width: 1400px) {
        .main-content {
          margin-left: 350px;
        }
      }

      @media (max-width: 1200px) {
        .main-content {
          margin-left: 300px;
        }

        @media (max-width: 992px) {
          .sidebar-illustration img {
            max-width: 200px !important;
          }

          .main-content {
            margin-left: 0;
          }

          .form-container {
            padding: 20px;
            border-radius: 30px;
          }
        }
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    {% include 'student/sidebar.html' %}

    <!-- Main Content -->
    <div class="main-content">
      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h1
            class="brand-font mb-2"
            style="
              font-size: 2.5rem;
              font-weight: 700;
              color: var(--primary-color);
            "
          >
            Fitness Test Results
          </h1>
          {% if latest_test %}
          <p class="info-text mb-0">
            <span class="badge bg-primary me-2"
              >{{ latest_test.get_test_type_display }}</span
            >
            Taken on: {{ latest_test.taken_at|date:"F d, Y" }}
          </p>
          {% else %}
          <p class="info-text mb-0">No fitness test recorded yet</p>
          {% endif %}
        </div>
        <div class="d-flex align-items-center">
          <div class="me-3" style="opacity: 0.5">
            <div
              style="width: 33.33px; height: 41.67px; background: #1d1b20"
            ></div>
          </div>
          <img src="{% static '' %}" alt="User Avatar" class="user-avatar" />
        </div>
      </div>

      <!-- Form Container -->
      <div class="form-container">
        <!-- Body Metrics Section -->
        <div class="mb-5">
          <h3 class="form-section-title">Body Metrics</h3>

          <div class="row mb-4">
            <div class="col-md-6">
              <label class="form-label">Height</label>
              <div class="position-relative">
                <input
                  type="text"
                  class="form-control form-input"
                  value="{{ latest_test.height_cm|default:'N/A' }}"
                  readonly
                />
                <div
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                >
                  <span class="unit-badge">cm</span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <label class="form-label">Weight</label>
              <div class="position-relative">
                <input
                  type="text"
                  class="form-control form-input"
                  value="{{ latest_test.weight_kg|default:'N/A' }}"
                  readonly
                />
                <div
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                >
                  <span class="unit-badge">kg</span>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
              <label class="form-label">BMI (computed)</label>
              <input
                type="text"
                class="form-control form-input"
                value="{% if latest_test.bmi %}{{ latest_test.bmi|floatformat:2 }}{% else %}N/A{% endif %}"
                readonly
              />
            </div>
          </div>
        </div>

        <!-- VO2 Max Section -->
        <div class="mb-5">
          <h3 class="form-section-title">VO<sub>2</sub> Max (Cooper 12-min)</h3>

          <div class="row mb-4">
            <div class="col-md-6">
              <label class="form-label">Distance Covered</label>
              <div class="position-relative">
                <input
                  type="text"
                  class="form-control form-input"
                  value="{{ latest_test.vo2_distance_m|default:'N/A' }}"
                  readonly
                />
                <div
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                >
                  <span class="unit-badge">m</span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <label class="form-label">VO<sub>2</sub> Max (computed)</label>
              <div class="position-relative">
                <input
                  type="text"
                  class="form-control form-input"
                  value="{% if latest_test.vo2_max %}{{ latest_test.vo2_max|floatformat:2 }}{% else %}N/A{% endif %}"
                  readonly
                />
                <div
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                >
                  <span class="unit-badge">ml/kg/min</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Fitness Profile Section -->
        <div class="mb-5">
          <h3 class="form-section-title">Fitness Profile</h3>

          <div class="row mb-4">
            <div class="col-md-6">
              <label class="form-label">Flexibility</label>
              <div class="position-relative">
                <input
                  type="text"
                  class="form-control form-input"
                  value="{{ latest_test.flexibility_cm|default:'N/A' }}"
                  readonly
                />
                <div
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                >
                  <span class="unit-badge">cm</span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <label class="form-label">Strength (push-ups)</label>
              <div class="position-relative">
                <input
                  type="text"
                  class="form-control form-input"
                  value="{{ latest_test.strength_reps|default:'N/A' }}"
                  readonly
                />
                <div
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                >
                  <span class="unit-badge">reps</span>
                </div>
              </div>
            </div>
          </div>

          <div class="row mb-4">
            <div class="col-md-6">
              <label class="form-label">Agility Test</label>
              <div class="position-relative">
                <input
                  type="text"
                  class="form-control form-input"
                  value="{{ latest_test.agility_sec|default:'N/A' }}"
                  readonly
                />
                <div
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                >
                  <span class="unit-badge">sec</span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <label class="form-label">Speed (40m)</label>
              <div class="position-relative">
                <input
                  type="text"
                  class="form-control form-input"
                  value="{{ latest_test.speed_sec|default:'N/A' }}"
                  readonly
                />
                <div
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                >
                  <span class="unit-badge">sec</span>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
              <label class="form-label">Endurance (1.5km)</label>
              <div class="position-relative">
                <input
                  type="text"
                  class="form-control form-input"
                  value="{{ latest_test.get_endurance_display|default:'N/A' }}"
                  readonly
                />
                <div
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                >
                  <span class="unit-badge">mm:ss</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      // Navigation active state
      document.addEventListener("DOMContentLoaded", function () {
        const navItems = document.querySelectorAll(".nav-item");

        navItems.forEach((item) => {
          item.addEventListener("click", function () {
            navItems.forEach((nav) => nav.classList.remove("active"));
            this.classList.add("active");
          });
        });
      });
    </script>
  </body>
</html>
